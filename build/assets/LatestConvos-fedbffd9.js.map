{"version":3,"file":"LatestConvos-fedbffd9.js","sources":["../../client/Page/Admin/DashboardWidget/Partials/LatestConvos.tsx"],"sourcesContent":["import { useState, useEffect, Fragment } from 'react';\nimport { Spinner } from '@/Components/Spinner';\nimport { useRestRequest } from '@/Providers/RestRequestProvider';\n\nexport default function LatestConvos() {\n  const { proxyApiRequest } = useRestRequest();\n  const [ isLoading, setIsLoading ] = useState< boolean >( true );\n  const [ historyGroups, setHistoryGroups ] = useState< App.Data.HistoryChronoGroupData[] >( [] );\n\n  useEffect( () => {\n    async function fetch() {\n      const history = await proxyApiRequest< App.Data.HistoryChronoGroupData[] >( 'convoHistory' );\n      setHistoryGroups( history );\n      setIsLoading( false );\n    }\n\n    fetch();\n  }, [] );\n\n  return (\n    <div className=\"max-h-[calc(100vh-275px)] min-h-[calc(100%-2rem)] overflow-y-auto p-3\">\n      { isLoading ? (\n        <div className=\"flex min-h-10 items-center justify-center\">\n          <Spinner show={ true } />\n        </div>\n      ) : historyGroups.length > 0 ? (\n        <div className=\"flex flex-col\">\n          { historyGroups.map( historyGroup => (\n            <Fragment key={ historyGroup.group }>\n              <h3>{ historyGroup.group }</h3>\n              { historyGroup.history.map( convo => (\n                <ConvoItem key={ convo.conversationId } { ...convo } />\n              ) ) }\n            </Fragment>\n          ) ) }\n        </div>\n      ) : (\n        <p>No recent conversations.</p>\n      ) }\n    </div>\n  );\n}\n\nfunction openConvo( since: string ) {\n  window.agentwp.dispatchEvent( new CustomEvent( 'awp:chat:since', { detail: { since } } ) );\n}\n\nfunction ConvoItem( convo: App.Data.HistoryData ) {\n  return (\n    <button\n      className=\"flex w-full justify-between p-2 text-left odd:bg-brand-gray-20\"\n      onClick={ () => openConvo( convo.conversationCreatedAt ) }>\n      <blockquote className=\"truncate\">{ convo.message }</blockquote>\n      <time className=\"ml-3 block text-nowrap text-sm font-semibold\">{ convo.humanCreatedAt }</time>\n    </button>\n  );\n}\n"],"names":["LatestConvos","proxyApiRequest","useRestRequest","isLoading","setIsLoading","useState","historyGroups","setHistoryGroups","useEffect","fetch","history","jsx","Spinner","historyGroup","jsxs","Fragment","convo","ConvoItem","openConvo","since"],"mappings":"8EAIA,SAAwBA,GAAe,CAC/B,KAAA,CAAE,gBAAAC,GAAoBC,IACtB,CAAEC,EAAWC,CAAa,EAAIC,WAAqB,EAAK,EACxD,CAAEC,EAAeC,CAAiB,EAAIF,EAAA,SAA+C,CAAG,CAAA,EAE9FG,OAAAA,EAAAA,UAAW,IAAM,CACf,eAAeC,GAAQ,CACf,MAAAC,EAAU,MAAMT,EAAsD,cAAe,EAC3FM,EAAkBG,CAAQ,EAC1BN,EAAc,EAAM,CACtB,CAEMK,GACR,EAAG,CAAG,CAAA,EAGJE,EAAAA,IAAC,MAAI,CAAA,UAAU,wEACX,SAAAR,EACCQ,EAAA,IAAA,MAAA,CAAI,UAAU,4CACb,SAACA,EAAA,IAAAC,EAAA,CAAQ,KAAO,EAAA,CAAO,EACzB,EACEN,EAAc,OAAS,EACxBK,EAAAA,IAAA,MAAA,CAAI,UAAU,gBACX,SAAcL,EAAA,IACdO,GAAAC,EAAAA,KAACC,EAAAA,SACC,CAAA,SAAA,CAACJ,EAAAA,IAAA,KAAA,CAAK,WAAa,KAAO,CAAA,EACxBE,EAAa,QAAQ,IACrBG,GAAAL,EAAA,IAACM,GAAyC,GAAGD,CAAA,EAA5BA,EAAM,cAA8B,CACrD,CAJY,CAAA,EAAAH,EAAa,KAK7B,CACA,CACJ,CAAA,EAECF,EAAAA,IAAA,IAAA,CAAE,mCAAwB,CAAA,CAE/B,CAAA,CAEJ,CAEA,SAASO,EAAWC,EAAgB,CAC3B,OAAA,QAAQ,cAAe,IAAI,YAAa,iBAAkB,CAAE,OAAQ,CAAE,MAAAA,EAAU,CAAA,CAAE,CAC3F,CAEA,SAASF,EAAWD,EAA8B,CAE9C,OAAAF,EAAA,KAAC,SAAA,CACC,UAAU,iEACV,QAAU,IAAMI,EAAWF,EAAM,qBAAsB,EACvD,SAAA,CAAAL,EAAA,IAAC,aAAW,CAAA,UAAU,WAAa,SAAAK,EAAM,QAAS,EACjDL,EAAA,IAAA,OAAA,CAAK,UAAU,+CAAiD,WAAM,eAAgB,CAAA,CAAA,CAAA,CAG7F"}