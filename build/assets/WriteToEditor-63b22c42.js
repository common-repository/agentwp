import{c as L}from"./_commonjsHelpers-725317a4.js";var k={},B={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Allow=t.ALL=t.COLLECTION=t.ATOM=t.SPECIAL=t.INF=t._INFINITY=t.INFINITY=t.NAN=t.BOOL=t.NULL=t.OBJ=t.ARR=t.NUM=t.STR=void 0,t.STR=1,t.NUM=2,t.ARR=4,t.OBJ=8,t.NULL=16,t.BOOL=32,t.NAN=64,t.INFINITY=128,t._INFINITY=256,t.INF=t.INFINITY|t._INFINITY,t.SPECIAL=t.NULL|t.BOOL|t.INF|t.NAN,t.ATOM=t.STR|t.NUM|t.SPECIAL,t.COLLECTION=t.ARR|t.OBJ,t.ALL=t.ATOM|t.COLLECTION,t.Allow={STR:t.STR,NUM:t.NUM,ARR:t.ARR,OBJ:t.OBJ,NULL:t.NULL,BOOL:t.BOOL,NAN:t.NAN,INFINITY:t.INFINITY,_INFINITY:t._INFINITY,INF:t.INF,SPECIAL:t.SPECIAL,ATOM:t.ATOM,COLLECTION:t.COLLECTION,ALL:t.ALL},t.default=t.Allow})(B);(function(t){var f=L&&L.__createBinding||(Object.create?function(n,r,c,e){e===void 0&&(e=c);var i=Object.getOwnPropertyDescriptor(r,c);(!i||("get"in i?!r.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return r[c]}}),Object.defineProperty(n,e,i)}:function(n,r,c,e){e===void 0&&(e=c),n[e]=r[c]}),d=L&&L.__exportStar||function(n,r){for(var c in n)c!=="default"&&!Object.prototype.hasOwnProperty.call(r,c)&&f(r,n,c)};Object.defineProperty(t,"__esModule",{value:!0}),t.Allow=t.MalformedJSON=t.PartialJSON=t.parseJSON=t.parse=void 0;const l=B;Object.defineProperty(t,"Allow",{enumerable:!0,get:function(){return l.Allow}}),d(B,t);class o extends Error{}t.PartialJSON=o;class b extends Error{}t.MalformedJSON=b;function h(n,r=l.Allow.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return A(n.trim(),r)}t.parseJSON=h;const A=(n,r)=>{const c=n.length;let e=0;const i=u=>{throw new o(`${u} at position ${e}`)},a=u=>{throw new b(`${u} at position ${e}`)},s=()=>(O(),e>=c&&i("Unexpected end of input"),n[e]==='"'?T():n[e]==="{"?m():n[e]==="["?J():n.substring(e,e+4)==="null"||l.Allow.NULL&r&&c-e<4&&"null".startsWith(n.substring(e))?(e+=4,null):n.substring(e,e+4)==="true"||l.Allow.BOOL&r&&c-e<4&&"true".startsWith(n.substring(e))?(e+=4,!0):n.substring(e,e+5)==="false"||l.Allow.BOOL&r&&c-e<5&&"false".startsWith(n.substring(e))?(e+=5,!1):n.substring(e,e+8)==="Infinity"||l.Allow.INFINITY&r&&c-e<8&&"Infinity".startsWith(n.substring(e))?(e+=8,1/0):n.substring(e,e+9)==="-Infinity"||l.Allow._INFINITY&r&&1<c-e&&c-e<9&&"-Infinity".startsWith(n.substring(e))?(e+=9,-1/0):n.substring(e,e+3)==="NaN"||l.Allow.NAN&r&&c-e<3&&"NaN".startsWith(n.substring(e))?(e+=3,NaN):_()),T=()=>{const u=e;let N=!1;for(e++;e<c&&(n[e]!=='"'||N&&n[e-1]==="\\");)N=n[e]==="\\"?!N:!1,e++;if(n.charAt(e)=='"')try{return JSON.parse(n.substring(u,++e-Number(N)))}catch(I){a(String(I))}else if(l.Allow.STR&r)try{return JSON.parse(n.substring(u,e-Number(N))+'"')}catch{return JSON.parse(n.substring(u,n.lastIndexOf("\\"))+'"')}i("Unterminated string literal")},m=()=>{e++,O();const u={};try{for(;n[e]!=="}";){if(O(),e>=c&&l.Allow.OBJ&r)return u;const N=T();O(),e++;try{const I=s();u[N]=I}catch(I){if(l.Allow.OBJ&r)return u;throw I}O(),n[e]===","&&e++}}catch{if(l.Allow.OBJ&r)return u;i("Expected '}' at end of object")}return e++,u},J=()=>{e++;const u=[];try{for(;n[e]!=="]";)u.push(s()),O(),n[e]===","&&e++}catch{if(l.Allow.ARR&r)return u;i("Expected ']' at end of array")}return e++,u},_=()=>{if(e===0){n==="-"&&a("Not sure what '-' is");try{return JSON.parse(n)}catch(N){if(l.Allow.NUM&r)try{return JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}a(String(N))}}const u=e;for(n[e]==="-"&&e++;n[e]&&",]}".indexOf(n[e])===-1;)e++;e==c&&!(l.Allow.NUM&r)&&i("Unterminated number literal");try{return JSON.parse(n.substring(u,e))}catch{n.substring(u,e)==="-"&&i("Not sure what '-' is");try{return JSON.parse(n.substring(u,n.lastIndexOf("e")))}catch(I){a(String(I))}}},O=()=>{for(;e<c&&` 
\r	`.includes(n[e]);)e++};return s()},w=h;t.parse=w})(k);function R(t,f){var d,l,o,b,h,A,w,n,r;try{if(t){const c=k.parse(t);if(!c.content){console.info("No content to write...");return}const i=c.content.length-1,a=c.content[i]||{};if(a.status=((d=f[i])==null?void 0:d.status)||"initial",a.clientId=((l=f[i])==null?void 0:l.clientId)||"",a.valid=((o=f[i])==null?void 0:o.valid)||void 0,!a.name||!wp.blocks.getBlockType(a.name)){console.info("Skipping... the block name is not valid...",a.name);return}return c.content[i].valid=!0,a.clientId?(b=a.attributes)!=null&&b.content&&((h=a.attributes)==null?void 0:h.content)!==((w=(A=f[i])==null?void 0:A.attributes)==null?void 0:w.content)?(c.content[i].status="updating_content",a.clientId?E(a).then(s=>{s&&(c.content[i].clientId=s)}):y(a).then(s=>{c.content[i].clientId=s})):a.innerBlocks&&((n=a.innerBlocks)==null?void 0:n.length)>0&&JSON.stringify(a.innerBlocks)!==JSON.stringify((r=f[i])==null?void 0:r.innerBlocks)&&(c.content[i].status="updating_inner_blocks",a.clientId?M(a).then(s=>{s&&(c.content[i].clientId=s)}):y(a).then(s=>{c.content[i].clientId=s})):y(a).then(s=>{c.content[i].clientId=s,c.content[i].status="ready"}),c}}catch(c){console.info("Error writing to editor",c)}}async function C(){try{const t=wp.data.select("core/block-editor").getBlocks();t&&t.length>0&&await wp.data.dispatch("core/block-editor").removeBlocks(t.map(f=>f.clientId))}catch(t){console.info("Error cleaning content",t)}}async function y(t){if(t.clientId)return;const{dispatch:f}=wp.data,{name:d,attributes:l}=t,o=wp.blocks.createBlock(d,l);return await f("core/block-editor").insertBlocks(o),o.clientId}async function E(t){if(!t.clientId)return;const{dispatch:f}=wp.data;return await f("core/block-editor").updateBlockAttributes(t.clientId,t.attributes),t.clientId}async function M(t){if(!t.clientId)return"";const{dispatch:f}=wp.data;try{const d=wp.blocks.createBlocksFromInnerBlocksTemplate(t.innerBlocks);if(d){const l=wp.blocks.createBlock(t.name,t.attributes||{},d);return await f("core/block-editor").replaceBlocks(t.clientId,l),l.clientId}}catch(d){console.error("Skipping... the block is incomplete...",d.message)}}export{C,R as W,k as d};
//# sourceMappingURL=WriteToEditor-63b22c42.js.map
